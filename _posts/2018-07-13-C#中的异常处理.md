---
permalink: /posts/csharp-exception
display: normal
title: C#ä¸­çš„å¼‚å¸¸å¤„ç†
tags: C#
emotag: ğŸ–Š
date: 2018-07-13T16:29:26.217Z
comment: true
layout: post
component: 
---

# åŸåˆ™

- ä¸è¦ä½¿ç”¨è¿”å›çŠ¶æ€å€¼çš„æ–¹å¼è¡¨ç¤ºå¼‚å¸¸ã€‚

- ä¸è¦ä½¿ç”¨ç©ºcatchï¼Œæ— æ³•å¤„ç†çš„å¼‚å¸¸è¦ç»§ç»­ä¸ŠæŠ›ã€‚

# çº¦å®š

## æŠ›å‡ºå¼‚å¸¸

- åœ¨catchä¸­ç»§ç»­ä¸ŠæŠ›å¼‚å¸¸æ—¶ï¼Œä½¿ç”¨`throw`è€Œä¸æ˜¯`throw ex`ï¼Œè¿™æ ·å¼‚å¸¸æŠ›å‡ºä½ç½®ä¸ä¼šè¢«æ­¤catchæˆªæ–­ã€‚

- å¼‚å¸¸ä¿¡æ¯ï¼ˆMessageï¼‰è¦æ–‡æ³•æ­£ç¡®ï¼Œä»¥ç»“æŸç¬¦ï¼ˆå¥å·ï¼‰ç»“å°¾ã€‚

- æä¾›é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚æŠ›å‡ºFileNotFoundExceptionæ—¶æä¾›FileNameã€‚

## ä½¿ç”¨.Netå†…ç½®å¼‚å¸¸

- ä¸è¦ä½¿ç”¨`System.Exception`ï¼Œè€Œè¦ä½¿ç”¨å®ƒçš„å­ç±»ã€‚  
å¦‚`InvalidOperationException`ã€`ArgumentException`ã€‚

## è‡ªå®šä¹‰å¼‚å¸¸

- åå­—ä»¥Exceptionç»“å°¾ã€‚

- ä½¿å¼‚å¸¸å¯åºåˆ—åŒ–ï¼Œå¹¶å°†å¼‚å¸¸å®šä¹‰æ”¾åœ¨å…¬å…±ç¨‹åºé›†ä¸­ã€‚ä»¥ä½¿å¼‚å¸¸åœ¨è¿œç¨‹è°ƒç”¨æˆ–è·¨åº”ç”¨åŸŸæ—¶å¯ç”¨ã€‚

- å®šä¹‰ä¸‰ä¸ªæ„é€ å‡½æ•°ã€‚

```csharp
[Serializable]
public class ExampleException: Exception
{
    public ExampleException()
    {
    }

    public ExampleException(string message)
        : base(message)
    {
    }

    public ExampleException(string message, Exception inner)
        : base(message, inner)
    {
    }
}
```

# å®è·µ

## GUI

å¯¹äºä½¿ç”¨`Application.ThreadException`æ•è·æ‰€æœ‰

## ä½¿ç”¨å¸®åŠ©ç±»

```csharp
// throw NewFileIOException();

FileReaderException NewFileIOException()
{
    string description = "My NewFileIOException Description";
    return new FileReaderException(description);
}
```

## ä¸‰ç§æ¨¡å¼

### Try-Parse æ¨¡å¼

```csharp
public struct DateTime
{
    public static DateTime Parse(string dateTime)
    {
    }
    public static bool TryParse(string dateTime, out DateTime result)
    {
    }
}
```
ä½¿ç”¨`Try`å‰ç¼€åŠè¿”å›`bool`å˜é‡ã€‚  
åŒæ—¶æä¾›ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆä¸å¸¦Tryï¼‰çš„æ–¹æ³•ã€‚

### Tester-Doer æ¨¡å¼

```csharp
if (conn.State != ConnectionState.Closed)
{
    conn.Close();
}
```
å½“å¼‚å¸¸ç»å¸¸å‘ç”Ÿæˆ–æœ¬èº«ä¸ºæ­£å¸¸æµç¨‹çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œæ¨èæ­¤ç§æ¨¡å¼ã€‚

### Try-Catch æ¨¡å¼

```csharp
try
{
    conn.Close();
}
catch (InvalidOperationException ex)
{
    Console.WriteLine(ex.GetType().FullName);
    Console.WriteLine(ex.Message);
}
```
å½“å¼‚å¸¸å¾ˆå°‘å‘ç”Ÿæ—¶ï¼ˆå³å¼‚å¸¸æ˜¯ä¸€ä¸ªé¢„æœŸå¤–é”™è¯¯ï¼‰ï¼Œä½¿ç”¨æ­¤æ¨¡å¼å¯ä»¥å‡å°‘æ­£å¸¸æ‰§è¡Œæ—¶å¤šä½™çš„åˆ¤æ–­æ­¥éª¤ã€‚

# å‚è€ƒ

[Design Guidelines for Exceptions](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/exceptions)

[Handling and throwing exceptions in .NET](https://docs.microsoft.com/en-us/dotnet/standard/exceptions/)