---
permalink: /posts/git-commands
display: normal
title: gitå¸¸ç”¨å‘½ä»¤æ•´ç†
tags: git
emotag: ğŸš€
date: 2020-07-11T10:58:40.037Z
comment: true
layout: post
component: 
---

# gitå¸¸ç”¨å‘½ä»¤æ•´ç†

## å¸¸ç”¨å‘½ä»¤

### æ ¹æ®.gitignoreæ¸…é™¤ä»“åº“

```bash
git clean -dXf
```

### å°†å…¶ä»–åˆ†æ”¯mergeåˆ°å½“å‰åˆ†æ”¯

mergeå‘½ä»¤ä¼šæ›´æ–°å½“å‰åˆ†æ”¯ï¼ˆåˆ°ç›®æ ‡åˆ†æ”¯ï¼‰ï¼Œè‹¥æƒ³åè¿‡æ¥å°†ç›®æ ‡åˆ†æ”¯æ›´æ–°åˆ°å½“å‰åˆ†æ”¯ï¼Œå¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

```bash
git fetch . develop:master
# git fetch <remote> <sourceBranch>:<destinationBranch>
# å½“å‰åœ¨developåˆ†æ”¯ï¼Œmasteråˆ†æ”¯è½åï¼Œå°†masteråˆ†æ”¯æ›´æ–°åˆ°developåˆ†æ”¯
# ä½¿ç”¨SourceTreeå¯æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ git fetch . $BRANCH :master
```

ä»¥ä¸Šå‘½ä»¤ç›¸å½“äºï¼š

```bash
git checkout master  # åˆ‡æ¢åˆ°masteråˆ†æ”¯
git merge develop    # å°†masteråˆ†æ”¯åŒæ­¥åˆ°develop
git checkout develop # åˆ‡æ¢å›developåˆ†æ”¯
```

### ç»Ÿè®¡ä»£ç è¡Œæ•°

```bash
# bashä»£ç ï¼Œéœ€è¦åœ¨linuxç¯å¢ƒæ‰§è¡Œ
git log --format='%aE' | \
    sort -u | \
    while read name; do echo -en "$name\t"; git log --author="$name" --pretty=tformat: --numstat | \
    awk '{ add += $1; subs += $2; diff += $1 + $2; loc += $1 - $2 } END { printf "add: %6s, remove: %6s, diff: %6s, sum: %6s\n", add, subs, diff, loc }' -; \
    done
```

*æ¸©é¦¨æç¤ºï¼šä»£ç è¡Œæ•°æ— æ³•åˆ¤å®šè´¡çŒ®å€¼å¤§å°*

ç½‘ä¸Šèƒ½æœåˆ°çš„ä»£ç ä½¿ç”¨ç”¨æˆ·åç»Ÿè®¡ï¼Œè¿™é‡Œæ”¹ä¸ºä½¿ç”¨emailæ¥ç»Ÿè®¡ï¼Œå¹¶å¢åŠ äº†diffä¸€æ ã€‚

### å¼•ç”¨å…¶ä»–ä»“åº“ä»£ç (submodule)

submoduleå¯¹äºæœ¬ä»“åº“è€Œè¨€ï¼Œä»…æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå¹¶ä¸ä¼šå°†submoduleçš„ä»£ç é‡å¤ä¸Šä¼ ï¼Œè¿™æ ·ä¿è¯äº†å…¬å…±ä»£ç åœ¨äº‘ç«¯ä»…æœ‰ä¸€ä»½ã€‚

```bash
git submodule add http://URL                    # æ·»åŠ å¼•ç”¨
git submodule update --init --recursive         # æ›´æ–°
```

## å…¨å±€è®¾ç½®

### ä½¿gitè®°ä½ç”¨æˆ·åå¯†ç 

```bash
git config --global credential.helper store
```

### è®¾ç½®ç”¨æˆ·ååŠé‚®ç®±

åœ¨ä½¿ç”¨gitä¹‹å‰ï¼Œå¿…é¡»æ­£ç¡®è®¾ç½®é‚®ç®±åï¼Œå¦åˆ™ä¼šä¸Šä¼ å¤±è´¥ã€‚

```bash
git config --global user.name "ç”¨æˆ·å"
git config --global user.email "é‚®ç®±å@é‚®ç®±.com"
```

### å¯¹ç›®å½•æ–‡ä»¶åå¤§å°å†™æ•æ„Ÿ

```bash
git config --global core.ignorecase false
```

### ç»Ÿä¸€æ–‡ä»¶æ¢è¡Œç¬¦

```bash
# ç»Ÿä¸€æ¢è¡Œç¬¦ä¸º crlf
git config --global core.eol crlf
# å°†è‡ªåŠ¨è½¬æ¢å…³é—­,é¿å…è½¬æ¢å¤±è´¥ä¸èƒ½ä¸åŒè¿›è¡Œæäº¤
git config --global core.autocrlf true
# ç¦æ­¢æ··ç”¨ lf å’Œ crlf ä¸¤ç§æ¢è¡Œç¬¦
git config --global core.safecrlf false
```

è‡ªåŠ¨è½¬æ¢æ¢è¡Œç¬¦(autocrlf)æœ€å¥½é…åˆ`.gitattributes`æ–‡ä»¶æŒ‡å®šæ¢è¡Œç¬¦æ ¼å¼ï¼š

```txt
* text eol=lf
```

## å¸¸è§é—®é¢˜å¤„ç†

### ä¿®æ”¹æœ¬åœ°æäº¤(commit)çš„é‚®ç®±

è‹¥å·²åœ¨æœ¬åœ°ä½¿ç”¨é”™è¯¯çš„é‚®ç®±æäº¤ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ä¿®æ”¹åä¸Šä¼ ã€‚

```bash
#!/bin/sh

git filter-branch --env-filter '

OLD_EMAIL="è¦ä¿®æ”¹çš„æ—§é‚®ç®±"
CORRECT_NAME="æ­£ç¡®çš„ç”¨æˆ·å"
CORRECT_EMAIL="æ­£ç¡®çš„é‚®ç®±@é‚®ç®±.com"

if [ "$GIT_COMMITTER_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_COMMITTER_NAME="$CORRECT_NAME"
    export GIT_COMMITTER_EMAIL="$CORRECT_EMAIL"
fi
if [ "$GIT_AUTHOR_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_AUTHOR_NAME="$CORRECT_NAME"
    export GIT_AUTHOR_EMAIL="$CORRECT_EMAIL"
fi
' --tag-name-filter cat -- --branches --tags
```

### æ¸…é™¤æœªå¼•ç”¨ç»“ç‚¹

æŸäº›å­¤ç«‹çš„èŠ‚ç‚¹ä¼šå ç”¨ä»“åº“ç©ºé—´ï¼Œæˆ–é€ æˆåŒæ­¥é”™è¯¯ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¸…é™¤æ‰

```bash
git gc --prune=now      # æœ¬åœ°
git remote prune origin # è¿œç«¯
```

æˆ–åœ¨.gitæ–‡ä»¶å¤¹ä¸­ï¼Œç§»é™¤refs/remoteä¸­é”™è¯¯çš„èŠ‚ç‚¹ã€‚
